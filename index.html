<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org"></script>
    <style>
        body { margin: 0; background: #1a1a1a; color: white; font-family: sans-serif; text-align: center; }
        #slots { font-size: 60px; background: white; color: black; margin: 20px; padding: 20px; border-radius: 15px; }
        button { width: 80%; height: 70px; font-size: 24px; background: #e74c3c; color: white; border: none; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body onload="init()">
    <h1 id="balance">Загрузка...</h1>
    <div id="slots">0 | 0 | 0</div>
    <button onclick="play()">КРУТИТЬ!</button>
    <p style="opacity:0.3; font-size:10px; margin-top:20px;">Авто-сохранение активно</p>

    <script>
        var tg = window.Telegram.WebApp;
        tg.expand();

        var botToken = 'ТВОЙ_ТОКЕН_ОТ_BOTFATHER'; // ВСТАВЬ СЮДА ТОКЕН
        var score = 0;
        var n1=0, n2=0, n3=0;

        function init() {
            // Парсим очки из URL (?133)
            var query = window.location.search.substring(1).replace(/[^0-9]/g, '');
            score = parseInt(query) || 0;
            render();
        }

        function play() {
            if (score <= 0) { alert("Очки кончились!"); return; }
            n1 = Math.floor(Math.random() * 10);
            n2 = Math.floor(Math.random() * 10);
            n3 = Math.floor(Math.random() * 10);

            if (n1 == n2 && n1 == n3) score += 500;
            else score -= 1;

            render();
            sync(); // Авто-синхронизация при каждом клике
        }

        function render() {
            document.getElementById('balance').textContent = "Очки: " + score;
            document.getElementById('slots').textContent = n1 + " | " + n2 + " | " + n3;
        }

        function sync() {
            var userId = tg.initDataUnsafe.user.id;
            // Шлем "тихий" запрос через API Telegram
            fetch(`https://api.telegram.org{botToken}/sendMessage?chat_id=${userId}&text=UP:${score}&disable_notification=true`);
        }
    </script>
</body>
</html>
